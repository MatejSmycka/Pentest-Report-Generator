<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Generator</title>
</head>
<body>
<form onsubmit="return Def()">
    Finding Name: <input type="text" id="name" size="100" name="name" required><br>

    CVSS number: <input type="text" id="cvss" size="100" name="cvss" value="8.8" required><br>
    CVSS text: <input type="text" id="cvss1" size="100" name="cvss1" value="(AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)"><br>
    Impact: <input type="text" id="imp" size="100" name="imp"><br>
    Hosts: <input type="text" id="host" size="100" name="host"><br>
    Role: <input type="text" id="role" size="100" name="role" value="unauthenticated"><br>
    Description: <textarea rows="5" cols="100" id="desc" name="Description"></textarea><br>
    Bussines impact: <textarea rows="5" cols="100" id="impact" name="impact"></textarea><br>
    Remediation: <textarea rows="5" cols="100" id="Remediation" name="Remediation"></textarea><br>
    References: <textarea
        placeholder="PŘÍKLAD: \href{https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html}{- Owasp}\\"
        rows="5" cols="100" id="References" name="References"></textarea><br>
    Steps to reproduce: <textarea placeholder="PŘÍKLAD: \begin{enumerate} #OČÍSLOVANÝ SEEZNAM NEBO \begin{itemize}  #BODY
\item Go to the GitLab sign in page at \url{http://thefactory.warehouse.lebonboncroissant.com/users/sign\_in.}
\item Login with the username `root` and password <redacted>.
\end{enumerate} NEBO \end{itemize}" rows="5" cols="100" id="Steps" name="Steps"></textarea><br>
    <br>
    <input type="submit" value="Submit"><br><br><br>
    #Vygeneruje LaTeX finding. Některé pole se nemusí vyplňovat
</form>

<script>
    function Def() {
        var cvss = document.getElementById("cvss").value;
        var cvss1 = document.getElementById("cvss1").value;
        var name = document.getElementById("name").value;
        var impact = document.getElementById("impact").value;
        var desc = document.getElementById("desc").value;
        var rem = document.getElementById("Remediation").value;
        var resc = document.getElementById("References").value;
        var steps = document.getElementById("Steps").value;
        if (cvss >= 9) {
            severity = 'Critical'
            color = 'red'
        } else if (cvss >= 7) {
            severity = 'High'
            color = 'red'
        } else if (cvss >= 4) {
            severity = 'Medium'
            color = 'orange'
        } else if (cvss > 0) {
            severity = 'Low'
            color = 'green'
        } else {
            severity = 'Info'
            color = 'cyan'
        }
        if (cvss != "") {
            cvss = '\\hline Severity: & \\textcolor{' + color + '}{CVSS ' + cvss + ' - ' + severity + '} ' + cvss1 + '\\\\\n'
        }
        var imp = document.getElementById("imp").value;
        if (imp != "") {
            imp = '\\hline Impact: & ' + imp + '\\\\\n'
        }
        var host = document.getElementById("host").value;
        if (host != "") {
            host = '\\hline Hosts: & ' + host + '\\\\\n'
        }
        var role = document.getElementById("role").value;
        if (role != "") {
            role = '\\hline Role: &' + role + ' \\\\\n'
        }
        if (desc != "") {
            desc = '\\textbf{Description} \\\\' + desc + '\\\\\\\\'
        }
        if (impact != "") {
            impact = '\\textbf{Bussines impact}\\\\' + impact + '\\\\\\\\'
        }
        if (rem != "") {
            rem = '\\textbf{Remedation}\\\\' + rem + '\\\\\\\\'
        }
        if (resc != "") {
            resc = '\\textbf{References}\\\\' + resc + '\\\\\\\\'
        }
        if (steps != "") {
            steps = '\\textbf{Steps to reproduce}\\\\' + steps + '\\\\\\\\'
        }
        document.write('<textarea  rows="25" cols="100" >' +
            '\\subsection{' + name + '}' +
            '\\begin{table}[h]\n' +
            '\\centering\n' +
            '\\begin{tabular}{|l|r|}\n' +
            '\\rowcolor{'+color+'}\n' +
            '\\hline & \\\\\n' +
            cvss +
            imp +
            host +
            role +
            '\\hline\n' +
            '\\end{tabular}\n' +
            '\\end{table}\n' +
            desc +
            impact +
            rem +
            resc +
            steps +
            '\n</textarea><br><br><br><a href="FindingGenerator.html">Nový finding</a>');
    }
</script>

</body>
</html>